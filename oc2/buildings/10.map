SETFREQUENCY=30		// factory
//JN 23.5.2005, 12.6.2005

BUILDWIDTH=RAND(25;55)
SETV10=RAND(0;10)	// smokestack
SETV1=RAND(0;9)	// floors
FLOORHEIGHT=RAND(4;5)
ELEVINTERVAL=RAND(10;20)
DOORINTERVAL=RAND(6;10)
SETX=BUILDBEGIN
GROUNDLEVEL(BUILDBEGIN;BUILDWIDTH;1)
GOTOLOW(BUILDBEGIN;BUILDWIDTH)

SETV20=BUILDWIDTH
SUBV20(5)
IFV10(0;3)	// left smokestack
	RIGHT(5)
ENDIF

MATERIAL=4

SETV2=1		// basement floors
IFV1(5;10)
	SETV2=RAND(2;3)
ENDIF

SETV3=Y
DOORTYPE=2
OUTSIDE=0

BEGIN
	DOWN(FLOORHEIGHT)
	BUILDFLOOR(X;V20;Y)
REPEAT V2

MATERIAL=5
SETV6=0

BEGIN
	IFBLOCK(6;6)
		BRIGHT(4)
	ENDIF

	RIGHT(1)
	ADDV6(1)
REPEAT BUILDWIDTH

LEFT(V6)

DIVV6(2)	// pipe
RIGHT(V6)
SETV13=Y
DOWN(1)
MATERIAL=40
BDOWN(1)
UP(1)
LEFT(V6)

SETY=V3

SETV4=RAND(0;10)	// material
MATERIAL=10			// element
SETV8=10
IFV4(0;5)
	SETV8=7
	MATERIAL=7		// brick
ENDIFV

OUTSIDE=1
BUILDFLOOR(X;V20;Y)
UP(FLOORHEIGHT)

OUTSIDE=0
BEGIN
	BUILDFLOOR(X;V20;Y)
	UP(FLOORHEIGHT)
REPEAT V1

RIGHT(2)
UP(1)
SETV7=RAND(0;10)

SETV6=V20
DIVV6(3)

IFV7(0;5)
//	RIGHT(V20)
ENDIF

SETV9=V8
ADDV9(1)

BEGIN
	RIGHT(3)
	DOWN(1)
	IFBLOCK(7;12)
		LEFT(3)
		UP(1)
		MATERIAL=26
		BUP(1)
		RIGHT(1)
		MATERIAL=27
		BUP(1)
		UPRIGHT(1)
		MATERIAL=26
		BUP(1)
		MATERIAL=18
		DOWN(1)
		BDOWN(1)
	ENDIF
	RIGHT(1)
REPEAT V6

UP(5)
ADDV8(1)
MATERIAL=V8
ADDV1(V2)
MULV1(5)
ADDV1(12)

SETY=V13

IFV10(0;3)	// left smokestack
	SETX=BUILDBEGIN
	UP(1)
	BUP(V1)
	RIGHT(4)
	BUP(V1)
	DOWN(1)
	BLEFT(5)
	UP(5)
	BRIGHT(3)
	DOWN(5)
	UP(V1)
	ADDV8(1)
	MATERIAL=V8
	BEGIN
		LEFT(1)
		BDOWN(V1)	
	REPEAT 3
ENDIF

IFV10(4;6)	// right smokestack
	SETX=BUILDBEGIN
	RIGHT(V20)
	UP(1)
	BUP(V1)
	RIGHT(4)
	BUP(V1)
	DOWN(1)
	BLEFT(5)
	UP(5)
	LEFT(5)
	BLEFT(2)
	RIGHT(5)
	DOWN(5)
	UP(V1)
	ADDV8(1)
	MATERIAL=V8
	BEGIN
		LEFT(1)
		BDOWN(V1)	
	REPEAT 3
ENDIF
